<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE boost_serialization>
<boost_serialization signature="serialization::archive" version="9">
<shader_source class_id="0" tracking_level="0" version="1">
	<px class_id="1" tracking_level="1" version="0" object_id="_0">
		<types class_id="2" tracking_level="0" version="0">
			<count>2</count>
			<item_version>0</item_version>
			<item>11</item>
			<item>13</item>
		</types>
		<name class_id="3" tracking_level="0" version="0">
			<str>parallax_slope_mapping</str>
		</name>
		<datas class_id="4" tracking_level="0" version="0">
			<count>2</count>
			<item_version>0</item_version>
			<item class_id="5" tracking_level="0" version="0">
				<parameters class_id="6" tracking_level="0" version="0">
					<count>6</count>
					<item_version>0</item_version>
					<item class_id="7" tracking_level="0" version="0">
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>fragment_normal</str>
						</name>
						<type>14</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>fragment_uv</str>
						</name>
						<type>13</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>normal_sampler</str>
						</name>
						<type>26</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>tbn_matrix</str>
						</name>
						<type>20</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>world_uv</str>
						</name>
						<type>13</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>world_view_direction</str>
						</name>
						<type>15</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
				</parameters>
				<version>0</version>
				<source>
					<str>vec4 normal;
vec3 uv, view_dir;
float h;
int i;
const vec2 scale_bias = vec2(0.06, -0.03) * 0.5;

view_dir = transpose(tbn_matrix) * world_view_direction.xyz;
uv = vec3(world_uv, 0.0);

for (i = 0; i &lt; 3; i++)
{
	normal = texture2D(normal_sampler, uv.xy);
	normal.xy = normal.xy * 2.0 - 1.0;
	normal.z = 1.0 - length(normal.xy);
	h = normal.a * scale_bias.x + scale_bias.y;
	uv += (h - uv.z) * normal.z * view_dir;
}

normal.xyz = normalize(normal.xyz * 2.0 - 1.0);
fragment_normal = tbn_matrix * normal.xyz;
fragment_uv = uv.xy;
</str>
				</source>
			</item>
			<item>
				<parameters>
					<count>6</count>
					<item_version>0</item_version>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>fragment_normal</str>
						</name>
						<type>14</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>fragment_uv</str>
						</name>
						<type>13</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>normal_sampler</str>
						</name>
						<type>26</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>tbn_matrix</str>
						</name>
						<type>20</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>world_uv</str>
						</name>
						<type>13</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>parallax_slope_mapping_uv_mapping_normal_mapping</str>
						</source>
						<name>
							<str>world_view_direction</str>
						</name>
						<type>15</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
				</parameters>
				<version>0</version>
				<source>
					<str>vec4 normal;
vec3 uv, view_dir;
float h;
int i;
const vec2 scale_bias = vec2(0.06, -0.03);

view_dir = transpose(tbn_matrix) * world_view_dir.xyz;
uv = vec3(world_uv, 0.0);

for (i = 0; i &lt; 3; i++)
{
	normal = texture(normal_sampler, uv.xy);
	normal.z = 1.0 - sqrt(dot(normal.xy, normal.xy));
	h = normal.a * scale_bias.x + scale_bias.y;
	uv += (h - uv.z) * normal.z * view_dir;
}

normal.xyz = normalize(tbn_matrix * normal.xyz);
fragment_normal = normal.xyz;
fragment_uv = uv.xy;
</str>
				</source>
			</item>
		</datas>
	</px>
</shader_source>
</boost_serialization>

