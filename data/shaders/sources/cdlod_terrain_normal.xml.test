<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE boost_serialization>
<boost_serialization signature="serialization::archive" version="9">
<shader_source class_id="0" tracking_level="0" version="1">
	<px class_id="1" tracking_level="1" version="0" object_id="_0">
		<types class_id="2" tracking_level="0" version="0">
			<count>1</count>
			<item_version>0</item_version>
			<item>1</item>
		</types>
		<name class_id="3" tracking_level="0" version="0">
			<str>cdlod-terrain</str>
		</name>
		<datas class_id="4" tracking_level="0" version="0">
			<count>2</count>
			<item_version>0</item_version>
			<item class_id="5" tracking_level="0" version="0">
				<parameters class_id="6" tracking_level="0" version="0">
					<count>8</count>
					<item_version>0</item_version>
					<item class_id="7" tracking_level="0" version="0">
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>position</str>
						</name>
						<type>15</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>terrain_instances</str>
						</name>
						<type>18</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1000</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>terrain_lod_offset</str>
						</name>
						<type>15</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>terrain_texture_coordinate</str>
						</name>
						<type>13</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>vertex_normal_sampler</str>
						</name>
						<type>31</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>vertex_vector_sampler</str>
						</name>
						<type>31</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>world_normal</str>
						</name>
						<type>14</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>world_position</str>
						</name>
						<type>14</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
				</parameters>
				<version>2</version>
				<source>
					<str>mat2x4 terrain_instance;
vec3 vertex_position;
vec2 fenc, vertex_uv, morph_dir;
float f, g, morph, dist;

terrain_instance = terrain_instances[gl_InstanceID];

morph_dir = fract(position.xy * 0.5) * terrain_instance[0].w;
vertex_uv = terrain_instance[0].xy + position.xy * terrain_instance[0].z;
vertex_position = vec3(vertex_uv * terrain_lod_offset.w, 0.0);
dist = length(vertex_position + terrain_lod_offset.xyz);
morph = clamp(dist * terrain_instance[1].x + terrain_instance[1].y, 0.0, 1.0);
vertex_uv += morph_dir * morph;
vertex_position = vec3(vertex_uv * terrain_lod_offset.w, 0.0);
vertex_position +=decode_terrain_displacement( texture(vertex_vector_sampler, vertex_uv));
world_position = vertex_position;

world_normal = decode_normal(texture(vertex_normal_sampler, vertex_uv).rg);

terrain_texture_coordinate = vertex_position.xy;
</str>
				</source>
			</item>
			<item>
				<parameters>
					<count>5</count>
					<item_version>0</item_version>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>normal</str>
						</name>
						<type>15</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>position</str>
						</name>
						<type>15</type>
						<qualifier>0</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>terrain_texture_coordinate</str>
						</name>
						<type>13</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>world_normal</str>
						</name>
						<type>14</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
					<item>
						<source>
							<str>cdlod-terrain_world_normal_transformation</str>
						</source>
						<name>
							<str>world_position</str>
						</name>
						<type>14</type>
						<qualifier>1</qualifier>
						<size>0</size>
						<scale>1</scale>
					</item>
				</parameters>
				<version>0</version>
				<source>
					<str>world_position = position.xyz;
world_normal = normal.xyz;
terrain_texture_coordinate = position.xy;
</str>
				</source>
			</item>
		</datas>
	</px>
</shader_source>
</boost_serialization>

